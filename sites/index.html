<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Ilija Vukotic">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Sites - ATLAS Analytics</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-3194765-3', 'ATLAS-Analytics');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">ATLAS Analytics</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="active">
                        <a href="./">Sites</a>
                    </li>
                    <li >
                        <a href="../ADC/">ADC</a>
                    </li>
                    <li >
                        <a href="../accounting/">Accounting</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Infrastructure <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Data sources</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../data-sources/Distributed_processing/">Distributed Processing</a>
</li>
            
<li >
    <a href="../data-sources/fts/">FTS</a>
</li>
            
<li >
    <a href="../data-sources/perfsonar/">PerfSONAR</a>
</li>
            
<li >
    <a href="../data-sources/xaod/">xAOD</a>
</li>
            
<li >
    <a href="../data-sources/benchmarks/">Benchmarks</a>
</li>
            
<li >
    <a href="../data-sources/rtt/">RTT</a>
</li>
            
<li >
    <a href="../data-sources/esnet/">ESnet</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Computing</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../infrastructure/computing_nodes/">Backend nodes </a>
</li>
            
<li >
    <a href="../infrastructure/analytics/">Analytics</a>
</li>
            
<li >
    <a href="../infrastructure/amq/">AMQ</a>
</li>
            
<li >
    <a href="../infrastructure/elasticsearch/">Elasticsearch</a>
</li>
            
<li >
    <a href="../infrastructure/hadoop/">Hadoop</a>
</li>
            
<li >
    <a href="../infrastructure/logstash/">Logstash</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../alarms_and_alerts/">Alarms and Alerts</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">User Guides</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../user-guide/es_and_kibana/">Elasticsearch & Kibana</a>
</li>
            
<li >
    <a href="../user-guide/hadoop/">Hadoop</a>
</li>
            
<li >
    <a href="../user-guide/spark/">Spark</a>
</li>
            
<li >
    <a href="../user-guide/pig/">Pig Latin</a>
</li>
            
<li >
    <a href="../user-guide/jupyter/">Jupyter</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../ADC/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/ATLAS-Analytics/ATLAS-Analytics/edit/master/docs/sites.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#site-administration">Site administration</a></li>
            <li><a href="#storage">Storage</a></li>
            <li><a href="#jobs-io">Jobs IO</a></li>
            <li><a href="#jobs">Jobs</a></li>
            <li><a href="#wide-area-network-issues">Wide Area Network issues</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="site-administration">Site administration</h1>
<h2 id="storage">Storage</h2>
<h2 id="jobs-io">Jobs IO</h2>
<p>Site movers collect information on all the input/output data transfers from the job. This data gets collected and indexed in ES at both CERN and UChicago. The data contains information on all the files that job accessesed or wrote, file sizes, rates, and a lot of metadata (filenames,workernode, etc.). Sites can use this data to:</p>
<ul>
<li>spot problematics WN (full or failed scratch disk, connection issue, missconfiguration)</li>
<li>spot LAN issues (bad links, congested switches, ...)</li>
<li>optimize access type (copy-to-scratch vs. direct access)</li>
<li>make purchasing decissions (switches, NICs, disks) </li>
</ul>
<p>Starting point should be this <a href="http://atlas-kibana.mwt2.org:5601/app/kibana#/dashboard/bc828870-f566-11e7-8f2f-ab6704660c79">Kibana dashboard</a>. To make it show only information from one sites add a line like this to the search bar:
   <code>sitnamee:MWT2</code>. First one would look at the visualization named <strong>errors</strong>. Nodes with more than a few errors most probably need a deep inspection. 
   For a deeper investigation we suggest looking separately at WNs connected to the same switch. This is easiest done by making a search like this: <code>sitename:MWT2 and hostname:uct2*</code>. Big difference in performance can point to a problem with a switch WNs are connected to, or link from that switch to the storage. Feel free to make a special visualization that splits all your WNs in groups, save it (please prepend name of your site to names of your visualizations) so you don't have to redo it every day. You can also save a copy of the dashboard and customize it to your liking. </p>
<h2 id="jobs">Jobs</h2>
<h2 id="wide-area-network-issues">Wide Area Network issues</h2>
<p>It si very important to quickly spot WAN connectivity issues. There are two easy ways to do it: </p>
<ul>
<li>Subscribe to an alert on network issues for your site. This check is described <a href="../alarms_and_alerts/#network-issues">HERE</a> and will alert you to low level problems (broken or saturated link, high packet loss, unstable path)</li>
<li>Look at the FTS queues for your site. Long queues can point to bad settings in your FTS server, unusual Rucio requests, etc. Starting point for this kind of investigation is the <a href="">FTS queues</a> kibana page. Simply search for all transfers where your site is a source and then where your site is a destination (eg. <code>src_site:MWT2</code> or <code>dest_site:MWT2</code>). While a few files waiting in a queue for a few hours is not of big concern, a lot of transfers waiting for a long time (agreagate waiting time in years) is of concern.</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
